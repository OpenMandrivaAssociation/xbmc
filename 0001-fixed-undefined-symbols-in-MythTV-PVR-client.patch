From 67facd5d9868474702cb8a3acf8be468e65df92b Mon Sep 17 00:00:00 2001
From: Anssi Hannula <anssi@xbmc.org>
Date: Sat, 3 Mar 2012 21:15:46 +0200
Subject: [PATCH] fixed: undefined symbols in MythTV PVR client

The MythTV PVR client uses functionality from libmythxml.a but does not
link it in. Additionally, it fails to implement several PVR channel
functions, and has a wrong name for GetChannelsAmount(). Also, it is
linked against libdl which it doesn't use.

To fix the undefined symbols, make the client link against libmythxml.a,
add stubs for the missing functions, and change GetNumChannels() to
GetChannelsAmount(). Also drop unused -ldl from the linking command
line.
---
 xbmc/pvrclients/mythtv/Makefile.in |    2 +-
 xbmc/pvrclients/mythtv/client.cpp  |   17 ++++++++++++++++-
 2 files changed, 17 insertions(+), 2 deletions(-)

diff --git a/xbmc/pvrclients/mythtv/Makefile.in b/xbmc/pvrclients/mythtv/Makefile.in
index 4de3ac5..5d02ff2 100644
--- a/xbmc/pvrclients/mythtv/Makefile.in
+++ b/xbmc/pvrclients/mythtv/Makefile.in
@@ -5,7 +5,7 @@
 # how to reach the author.
 #
 
-LIBS   = -ldl
+LIBS   = libmythxml/libmythxml.a
 LIBDIR = @abs_top_srcdir@/addons/pvr.mythtv
 LIB    = @abs_top_srcdir@/addons/pvr.mythtv/XBMC_Mythtv.pvr
 
diff --git a/xbmc/pvrclients/mythtv/client.cpp b/xbmc/pvrclients/mythtv/client.cpp
index 1b98a69..95f7c32 100644
--- a/xbmc/pvrclients/mythtv/client.cpp
+++ b/xbmc/pvrclients/mythtv/client.cpp
@@ -292,7 +292,7 @@ PVR_ERROR GetEPGForChannel(PVR_HANDLE handle, const PVR_CHANNEL &channel, time_t
 /*******************************************/
 /** PVR Channel Functions                 **/
 
-int GetNumChannels()
+int GetChannelsAmount(void)
 {
 	if (MythXmlApi == NULL)
 		return PVR_ERROR_SERVER_ERROR;
@@ -308,6 +308,21 @@ PVR_ERROR GetChannels(PVR_HANDLE handle, bool bRadio)
 	return MythXmlApi->requestChannelList(handle, bRadio);
 }
 
+int GetChannelGroupsAmount(void)
+{
+  return 0;
+}
+
+PVR_ERROR GetChannelGroups(PVR_HANDLE handle, bool bRadio)
+{
+  return PVR_ERROR_NOT_IMPLEMENTED;
+}
+
+PVR_ERROR GetChannelGroupMembers(PVR_HANDLE handle, const PVR_CHANNEL_GROUP &group)
+{
+  return PVR_ERROR_NOT_IMPLEMENTED;
+}
+
 PVR_ERROR DeleteChannel(const PVR_CHANNEL &channel)
 {
   return PVR_ERROR_NOT_IMPLEMENTED;
-- 
1.7.7.2

